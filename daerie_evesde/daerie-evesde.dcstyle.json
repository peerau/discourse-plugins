{"theme":{"id":7,"name":"Daerie EVESDE","created_at":"2018-09-08T11:13:16.748Z","updated_at":"2018-09-08T11:13:16.748Z","component":true,"color_scheme":null,"color_scheme_id":null,"user_selectable":false,"remote_theme_id":null,"user":{"id":1,"username":"warlof","name":"","avatar_template":"/user_avatar/forums.clandaerie.com/warlof/{size}/44_1.png","title":"Membre EVE Online"},"theme_fields":[{"name":"head_tag","target":"common","value":"\u003cscript type=\"text/javascript\" src=\"https://cf.eve-oj.com/js/EVEoj-0.3.x.min.js\"\u003e\u003c/script\u003e\n\u003cscript type=\"text/javascript\"\u003e\n    var SDEVer = 201611140,\n        SDD = EVEoj.SDD.Create('json', {'path': 'https://cf.eve-oj.com/sdd/' + SDEVer});\n\u003c/script\u003e\n\u003cscript type=\"text/x-handlebars\" data-template-name=\"modal/eve-sde-modal\"\u003e\n    {{#d-modal-body title=\"eve_sde_modal_title\" class=\"eve-sde-modal\"}}\n    \u003cp data-typeid=\"{{ model.type_id }}\"\u003e{{{ model.description }}}\u003c/p\u003e\n    {{#if model.attributes.shield }}\n    \u003ch4\u003eShield\u003c/h4\u003e\n    \u003ctable\u003e\n        \u003ctbody\u003e\n            \u003ctr\u003e\n                {{#each model.attributes.shield as |attribute|}}\n                \u003ctd\u003e\n                    \u003cimg src=\"{{ attribute.img.src }}\" alt=\"{{ attribute.img.alt }}\" /\u003e {{ attribute.value }}\n                \u003c/td\u003e\n                {{/each}}\n            \u003c/tr\u003e\n        \u003c/tbody\u003e\n    \u003c/table\u003e\n    {{/if}}\n    {{#if model.attributes.shield }}\n    \u003ch4\u003eArmor\u003c/h4\u003e\n    \u003ctable\u003e\n        \u003ctbody\u003e\n            \u003ctr\u003e\n                {{#each model.attributes.armor as |attribute|}}\n                \u003ctd\u003e\n                    \u003cimg src=\"{{ attribute.img.src }}\" alt=\"{{ attribute.img.alt }}\" /\u003e {{ attribute.value }}\n                \u003c/td\u003e\n                {{/each}}\n            \u003c/tr\u003e\n        \u003c/tbody\u003e\n    \u003c/table\u003e\n    {{/if}}\n    {{#if model.attributes.shield }}\n    \u003ch4\u003eHull\u003c/h4\u003e\n    \u003ctable\u003e\n        \u003ctbody\u003e\n            \u003ctr\u003e\n                {{#each model.attributes.hull as |attribute|}}\n                \u003ctd\u003e\n                    \u003cimg src=\"{{ attribute.img.src }}\" alt=\"{{ attribute.img.alt }}\" /\u003e {{ attribute.value }}\n                \u003c/td\u003e\n                {{/each}}\n            \u003c/tr\u003e\n        \u003c/tbody\u003e\n    \u003c/table\u003e\n    {{/if}}\n    {{/d-modal-body}}\n\u003c/script\u003e\n\u003cscript type=\"text/discourse-plugin\" version=\"0.8.24\"\u003e\n    const ESI_BASE_URI = 'https://esi.evetech.net';\n    const RESISTS = [109, 110, 111, 113, 267, 268, 269, 270, 271, 272, 273, 274];\n    const showModal = require('discourse/lib/show-modal').default;\n    let currentLocale = I18n.currentLocale();\n\n    // EvE Online Magic SDE\n    api.onAppEvent('modal:body-shown', msg =\u003e {\n        if (msg.title !== 'eve_sde_modal_title')\n            return;\n            \n        var typeID = $('.modal-body p').attr('data-typeid');\n        $('.modal-header .title h3 img').remove();\n        $('.modal-header .title h3').prepend(\n            $('\u003cimg\u003e').attr('src', `//image.eveonline.com/Type/${typeID}_32.png`)\n                      .attr('alt', 'Icon')\n                      .css('margin-right', '10px'));\n    });\n    \n    api.decorateCooked(function(cooked) {\n        SDD.LoadMeta()\n            .then(function(arg) {\n                return arg.source.GetTable('invTypes').Load();\n            })\n            .then(function(arg) {\n                cooked.find('a[href=\"#evesde\"]').each(function() {\n                    var typeName = $(this).text();\n                    results = _.filter(arg.table.data, function(entry) {\n                        return entry[arg.table.c.typeName] === typeName;\n                    });\n                \n                    if (results.length \u003e 0) {\n                        $(this).attr('data-typeid', results[0][arg.table.c.typeID]);\n                        $(this).on('click', function() {\n                            var typeID  = $(this).attr('data-typeid');\n                            var typeUri = ESI_BASE_URI + '/latest/universe/types/' + typeID + '/';\n                        \n                            $.ajax({\n                                data : {\n                                    language: 'fr'\n                                },\n                                dataType: 'json',\n                                headers: {\n                                    'Accept-Language': 'fr',\n                                    'X-User-Agent': 'discourse/1.0.0 (Warlof Tutsimo - Daerie Inc. - Get Off My Lawn)'\n                                },\n                                type: 'GET',\n                                url: typeUri\n                            }).done(function(data) {\n                                SDD.LoadMeta()\n                                    .then(function(arg) {\n                                        return arg.source.GetTable('dgmAttributeTypes').Load();\n                                    })\n                                    .then(function(arg) {\n                                        var sdeModel = {\n                                            'type_id': 0,\n                                            'description': '',\n                                            'attributes': {\n                                                'shield': [],\n                                                'armor': [],\n                                                'hull': []\n                                            }\n                                        };\n                                        \n                                        _.each(data.dogma_attributes, function(dgmAttribute) {\n                                            if (RESISTS.indexOf(dgmAttribute.attribute_id) \u003e= 0) {\n                                                results = _.filter(arg.table.data, function(entry) {\n                                                    return entry[arg.table.c.attributeID] === dgmAttribute.attribute_id;\n                                                });\n                                                \n                                                if (results.length \u003e 0) {\n                                                    var attribute = {\n                                                        'id': 0,\n                                                        'name': '',\n                                                        'value': '',\n                                                        'percent': 0,\n                                                        'img': {\n                                                            'alt': '',\n                                                            'src': ''\n                                                        }\n                                                    };\n                                                    \n                                                    switch (results[0][arg.table.c.iconID]) {\n                                                        case 1393:\n                                                            attribute.img.src = 'https://forums.clandaerie.com/uploads/default/original/1X/a948a8f3d0ac5a1628c110071aceef976db0fae5.png';\n                                                            break;\n                                                        case 1394:\n                                                            attribute.img.src = 'https://forums.clandaerie.com/uploads/default/original/1X/4d8ef4c39d6baa27845ff8931c63fc4c08cc7bbb.png';\n                                                            break;\n                                                        case 1395:\n                                                            attribute.img.src = 'https://forums.clandaerie.com/uploads/default/original/1X/281dbfadd89530cc1142a4b93fdc7ada671297eb.png';\n                                                            break;\n                                                        case 1396:\n                                                            attribute.img.src = 'https://forums.clandaerie.com/uploads/default/original/1X/b3f1e97f6144ec32c601294bfe2a2abc7cd9adfd.png';\n                                                            break;\n                                                    }\n                                                    \n                                                    attribute.id = dgmAttribute.attribute_id;\n                                                    attribute.name = results[0][arg.table.c.displayName];\n                                                    attribute.value = dgmAttribute.value;\n                                                    attribute.percent = Math.round((1 - attribute.value) * 100);\n                                                    attribute.img.alt = attribute.name.replace(/Armor|Shield|Structure/gi, '').trim();\n                                                    \n                                                    switch (results[0][arg.table.c.categoryID]) {\n                                                        // Shield\n                                                        case 2:\n                                                            sdeModel.attributes.shield.push(attribute);\n                                                            break;\n                                                        // Armor\n                                                        case 3:\n                                                            sdeModel.attributes.armor.push(attribute);\n                                                            break;\n                                                        // Structure\n                                                        case 4:\n                                                            sdeModel.attributes.hull.push(attribute);\n                                                            break;\n                                                    }\n                                                }\n                                            }\n                                        });\n                                        \n                                        sdeModel.type_id = typeID;\n                                        sdeModel.description = data.description\n                                            .replace(/\\r\\n/gi, '\u003cbr/\u003e')\n                                            .replace(/\\n\\n/gi, '\u003cbr/\u003e')\n                                            .replace(/\\n/gi, '\u003cbr/\u003e')\n                                            .replace(/\u003ccolor='0xff([a-f0-9]{6})'\u003e([a-z0-9,.']+)\u003c\\/color\u003e/gmi, function(match, p1, p2, offset, string) {\n                                                return `\u003cspan style=\"color: #${p1};\"\u003e${p2}\u003c/span\u003e`;\n                                            })\n                                            .replace(/\u003ca href=showinfo:([0-9]+)\u003e([éèàçù \\w]+)\u003c\\/a\u003e/gmi, function(match, p1, p2, offset, string) {\n                                                return p2;\n                                            });\n                                            \n                                        I18n.translations[currentLocale].js.eve_sde_modal_title = data.name;\n                                        \n                                        showModal('eveSdeModal', {\n                                            'model': sdeModel\n                                        });\n                                    });\n                            });\n                        });\n                    }\n                });\n            });\n    }, {onlyStream: true});\n\u003c/script\u003e","type_id":0},{"name":"scss","target":"common","value":".eve-sde-modal p {\n    text-align: justify;\n}\n","type_id":1}],"remote_theme":null}}